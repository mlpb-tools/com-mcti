<!DOCTYPE html>
<html lang="fr">
<head>
  <!-- ... HEAD INCHANGÉ ... -->
</head>
<body>
  <!-- ... CONTENU INCHANGÉ ... -->

  <script>
    // ... SCRIPT EXISTANT INCHANGÉ ...

    // Ajout de la fonction handleFileSelect
    function handleFileSelect(event) {
        const file = event.target.files[0];
        if (file) {
            window.selectedFile = file;
            document.getElementById('selectedFile').style.display = 'block';
            document.getElementById('fileName').textContent = file.name + ' (' + (file.size / 1024).toFixed(1) + ' Ko)';
        }
    }

    // Ajout de la fonction removeSelectedFile
    function removeSelectedFile() {
        window.selectedFile = null;
        document.getElementById('selectedFile').style.display = 'none';
    }

    // Ajout de la fonction downloadFile
    function downloadFile(fileId, fileName) {
        const message = messages.find(m => m.fileId === fileId);
        if (message && window.selectedFile) {
            const blob = new Blob([window.selectedFile], { type: message.fileType });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = fileName || 'document';
            a.style.display = 'none';
            document.body.appendChild(a);
            a.click();
            URL.revokeObjectURL(url);
            showNotification('Téléchargement lancé', 'success');
        } else {
            showNotification('Fichier introuvable', 'error');
        }
    }
  </script>
</body>
</html>
